Validation.add("validate-emailorphone","Please enter a valid email address or telephone number. For example johndoe@example.com or +38(099)999-99-99",function(a){return Validation.get("IsEmpty").test(a)||/^(\+\d{2}\(\d{3}\)\d{3}-\d{2}-\d{2})$/i.test(a)||Validation.get("validate-email").test(a)}),Validation.add("IsValidPhoneLength","Please enter a valid telephone number. For example +38(099)999-99-99",function(a){return a=a.replace(/[^0-9]/g,""),a.length>9&&a.length<13}),QMAdvancedFeedback=function(a){var b={},c={href:null,content:null,helpers:{overlay:{locked:!1}},afterClose:null},d=function(){return a("<div/>").addClass("advfeedback-overlay")},e=function(b,c){return a.each(c,function(a,c){b=b.replace("{{"+a+"}}",c)}),b},f=function(b){var d=b.confirmation;b.customer&&(d=e(d,b.customer)),a.fancybox(a.extend(c,{content:d,afterShow:function(){a(this.inner).find(".btn-close").on("click",function(b){b.preventDefault(),a.fancybox.close()})}}))},g=function(b){var b=a.extend({link:null,fancybox:c},b),d=a("a[href='#"+b.link+"'], button[data-href='#"+b.link+"']");d.length&&a.fancybox&&d.on("click",function(c){c.preventDefault(),a.fancybox(b.fancybox)})},h=function(b){var c=new VarienForm(b.form),b=a.extend({isAjax:!1,link:null,holder:null,form:null},b);if(g({link:b.link,fancybox:{href:"#"+b.holder,afterClose:function(){c.validator.reset()}}}),b.isAjax){var e=!1;a("#"+b.form).on("submit",function(b){b.preventDefault();var g=a(this),h=g.find(".message").hide(),i=g.find("input"),j=i.filter("[name*='[emailorphone]']");if(j.length){var k=j.val(),l=Validation.get("IsValidPhoneLength").test(k),m=k.replace(/[^a-z0-9]/gi,""),n=a.isNumeric(m),o="+38(099)999-99-99",p=k.length;n&&p&&l&&k.length<o.length&&(e||j.val(m),j.mask("+38(099)999-99-99"),j.on("keyup.mask",function(){0==this.value.length&&(j.unmask(),e=!1)}),e=!0),c.validator.validate()}if(!i.hasClass("validation-failed")){var q=d().appendTo(g.parent());a.post(g.attr("action")+"isAjax/1/",g.serialize(),function(b){"success"===b.r?(b.confirmation?f(b):a.fancybox.close(),g.trigger("reset")):h.fadeIn().html(b.error)},"json").complete(function(){q.remove()})}})}};return b.initCallback=h,b.initConsultation=h,b}(jQuery);